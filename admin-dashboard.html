<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css">
    <link rel="stylesheet" href="css/styles.css"> 
    <script type="module" src="js/admin.js" defer></script>
    <script type="module" src="js/auth.js" defer></script> 
    <script type="module" src="js/admin-request.js" defer></script>
    <link href="https://cdn.jsdelivr.net/npm/fullcalendar@5.11.0/main.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/fullcalendar@5.11.0/main.min.js"></script>
</head>
<body>
    <!-- Sidebar -->
    <div id="sidebar" class="admin-sidebar hidden">
        <button id="closeSidebar" class="closebtn">&times;</button>
        <a href="#" id="dashboardLink" onclick="openTab(event, 'home')">Home (Dashboard)</a>
        <a href="#" id="requestListLink" onclick="openTab(event, 'requestList')">Request List</a>
        <a href="#" id="manageUsersLink" onclick="openTab(event, 'manageUsers')">Manage Users</a>
        <a href="#" id="analysisReportLink" onclick="openTab(event, 'analysisReport')">Analysis Report</a>
        <a href="#" id="appointmentLink" onclick="openTab(event, 'appointment')">Appointment</a>
        <a href="#" id="eventsLink" onclick="openTab(event, 'events')">Events</a>
    </div>

    <!-- Page Content -->
    <div id="main">
        <!-- Header -->
        <header class="admin-header">
            <button id="openSidebar" class="openbtn">&#9776;</button>
            <div class="admin-logo">
                <div class="side-logo">
                    <img src="Logo.webp" class="side-logo" alt=>
                </div>

                <span class="logo-name">Center for Natural Science and Resources Research</span>
            </div>

            <div class="header-icons">
                <button id="helpBtn"><i class="fa-solid fa-question-circle"></i></button>
                <button id="notificationsBtn"><i class="fa-solid fa-circle-exclamation"></i></button>
                <button id="settingsBtn"><i class= "fa-solid fa-gear"></i></button>
            </div>
        </header>

        <!-- Main Content -->
        <div id="content" class="content">
            <!-- Admin Content -->
            <div id="admin-content" class="hidden">
                <!-- Add admin-specific content here -->
            </div>
            
            <!-- Error Message -->
            <div id="admin-error-message" class="hidden">
                <p>You are not authorized to view this content.</p>
            </div>

            <!-- Home Tab -->
            <div id="home" class="tabcontent hidden">
                <h2>Home</h2>
                <p>Welcome to the Admin Dashboard! Here you can manage clients, laboratory staff, and user requests.</p>
                <p>Select a section from the sidebar to get started.</p>
            </div>

            <!-- Request List Tab -->
            <div id="requestListContainer">
                <div id="requestList" class="tabcontent">
                    <div class="requestList">
                        <div style="border-bottom: 2px solid black;">
                            <h1>Request List</h1>
                            <div id="requestButtons" class="manageuserbutton">
                                <button class="color-change" id="allRequestsBtn" onclick="openTab(event, 'allRequests')">All Requests</button>
                                <button class="color-change" id="serviceRequestsBtn" onclick="openTab(event, 'serviceRequests')">Service Requests</button>
                                <button class="color-change" id="followUpRequestsBtn" onclick="openTab(event, 'followUpRequests')">Follow-up Requests</button>
                            </div>
                        </div>
                        <div id="table-container">
                            <div id="allRequests-table-container">
                                <div style="display: flex; justify-content: space-between;">
                                    <h2>All Requests</h2>
                                    <div style="margin-top: auto;">
                                        <input type="text" id="allRequestsSearch" placeholder="Search all requests...">
                                    </div>
                                </div>
                                <table id="allRequestsTable">
                                    <thead>
                                        <tr>
                                            <th>Date</th>
                                            <th>Request ID</th>
                                            <th>Client Type</th>
                                            <th>Client Name</th>
                                            <th>No. of Samples</th>
                                            <th>Request Type</th>
                                            <th style="width: 20%;text-align: center;">Action</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <!-- All requests will be inserted here -->
                                    </tbody>
                                </table>
                            </div>
                            <div id="serviceRequests-table-container" style="display: none;">
                                <div style="display: flex; justify-content: space-between;">
                                    <h2>Service Requests</h2>
                                    <div style="margin-top: auto;">
                                        <input type="text" id="serviceRequestsSearch" placeholder="Search service requests...">
                                    </div>
                                </div>
                                <table id="serviceRequestsTable">
                                    <thead>
                                        <tr>
                                            <th>Date</th>
                                            <th>Request ID</th>
                                            <th>Client Type</th>
                                            <th>Client Name</th>
                                            <th>No. of Samples</th>
                                            <th>Request Type</th>
                                            <th style="width: 20%;text-align: center;">Action</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <!-- Service requests will be inserted here -->
                                    </tbody>
                                </table>
                            </div>
                            <div id="followUpRequests-table-container" style="display: none;">
                                <div style="display: flex; justify-content: space-between;">
                                    <h2>Follow-up Requests</h2>
                                    <div style="margin-top: auto;">
                                        <input type="text" id="followUpRequestsSearch" placeholder="Search follow-up requests...">
                                    </div>
                                </div>
                                <table id="followUpRequestsTable">
                                    <thead>
                                        <tr>
                                            <th>Date</th>
                                            <th>Request ID</th>
                                            <th>Client Type</th>
                                            <th>Client Name</th>
                                            <th>No. of Samples</th>
                                            <th>Request Type</th>
                                            <th style="width: 20%;text-align: center;">Action</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <!-- Follow-up requests will be inserted here -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <div id="paginationControls" style="display: flex; justify-content: center; margin-top: 20px;">
                            <button id="prevPage" disabled>Previous</button>
                            <span id="pageInfo">Page 1</span>
                            <button id="nextPage">Next</button>
                        </div>
                        <div style="display: flex; justify-content: center; margin-top: 10px;">
                            <button id="requestHistoryBtn" style="margin-left: 20px;" >Request History</button> <!-- Button to show request history -->
                        </div>
                    </div>
                </div>

                <!-- Request History Section -->
                <div id="requestHistoryContainer" style="display: none;">
                    <div style="border-bottom: 2px solid black;">
                        <h1>Request History</h1>
                        <div id="requestHistoryButtons" class="manageuserbutton">
                            <button class="color-change" id="rejectedRequestsBtn" >Rejected Requests</button>
                            <button class="color-change" id="releasedRequestsBtn" >Released Requests</button>
                        </div>
                    </div>

                    <!-- Released Requests Table -->
                    <div id="releasedRequests-table-container" style="display: none;">
                        <div style="display: flex; justify-content: space-between;">
                            <h2>Released Requests</h2>
                            <input type="text" id="releasedRequestsSearch" placeholder="Search Released requests...">
                        </div>
                        <table id="releasedRequestsTable">
                            <thead>
                                <tr>
                                    <th>Date</th>
                                    <th>Request ID</th>
                                    <th>Client Type</th>
                                    <th>Client Name</th>
                                    <th>No. of Samples</th>
                                    <th>Request Type</th>
                                    <th style="width: 20%;text-align: center;">Action</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Released requests will be inserted here -->
                            </tbody>
                        </table>
                    </div>

                    <!-- Rejected Requests Table -->
                    <div id="rejectedRequests-table-container" style="display: none;">
                        <div style="display: flex; justify-content: space-between;">
                            <h2>Rejected Requests</h2>
                            <input type="text" id="rejectedRequestsSearch" placeholder="Search Rejected requests...">
                        </div>
                        <table id="rejectedRequestsTable">
                            <thead>
                                <tr>
                                    <th>Date</th>
                                    <th>Request ID</th>
                                    <th>Client Type</th>
                                    <th>Client Name</th>
                                    <th>No. of Samples</th>
                                    <th>Request Type</th>
                                    <th style="width: 20%;text-align: center;">Action</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Rejected requests will be inserted here -->
                            </tbody>
                        </table>
                    </div>

                    <div id="paginationControls" style="display: flex; justify-content: center; margin-top: 20px;">
                        <button id="prevHistoryPage" disabled>Previous</button>
                        <span id="historyPageInfo">Page 1</span>
                        <button id="nextHistoryPage">Next</button>
                    </div>
                </div>
            </div>

        <!-- Admin Request Details Section -->
        <div id="adminRequestDetailsSection" class="hidden">
            <h2 id="adminRequestDetailsHeader"></h2>
            <button id="backButton" >Back to Request List</button>
            <div id="adminRequestDetailsContent" class="request-details"></div>
        </div>

        <div id="appointmentPage" class="hidden">
            <!-- The content will be dynamically generated by the showAppointmentPage function -->
        </div>
          
            <!-- Analysis Report Tab -->
            <div id="analysisReport" class="tabcontent hidden">
                <h2>Analysis Report</h2>
                <p>No reports available at the moment.</p>
            </div>

            <!-- Appointment Tab -->
            <div id="appointment" class="tabcontent hidden">
                <h2>Appointments</h2>
                <table id="appointmentsTable">
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Request ID</th>
                            <th>Client Name</th>
                            <th>End Date</th>
                            <th>Assigned Staff</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td colspan="6">No appointments scheduled.</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- Edit Appointment Modal -->
            <div id="editModal" class="modal hidden">
                <div class="modal-content">
                    <span class="close">&times;</span>
                    <h2>Edit Appointment</h2>
                    <label for="staffSelect">Assigned Laboratory Staff:</label>
                    <select id="staffSelect"></select>
                    
                    <label for="endDate">Estimated End Date:</label>
                    <input type="date" id="endDate" />
                    
                    <button id="saveButton">Save</button>
                </div>
            </div>

            <!-- Events Tab -->
            <div id="events" class="tabcontent hidden">
                <div class="events-header">
                <h2>Events and Activities</h2>
                <input type="text" id="eventSearch" placeholder="Search Events..." style="margin-left: 20px;">
                <button id="addEventBtn" style="margin-left: 20px;">Add Event</button>
                </div>
                
                <div id="eventContainer" class="scroll-container">
                <!-- Scrollable event list will be rendered here -->
                </div>
            </div>
            
            <!-- Add Event Form - Initially Hidden -->
            <div id="addEventForm" style="display: none;">
                <h3>Add New Event</h3>

                <button id="closeAddEventForm" style="float: right;">Close</button>
            
                <!-- Image Upload Section -->
                <label for="eventImage">Upload Image:</label>
                <div id="imagePreview" style="border: 1px solid #ccc; width: 200px; height: 200px;"></div>
                <input type="file" id="eventImage">
                
                <!-- Event Fields -->
                <label for="eventTitle">Title:</label>
                <input type="text" id="eventTitle" placeholder="Event Title">
                
                <label for="eventDescription">Description:</label>
                <textarea id="eventDescription" placeholder="Event Description"></textarea>
                
                <label for="eventStartDate">Start Date:</label>
                <input type="date" id="eventStartDate">
                
                <label for="eventEndDate">End Date:</label>
                <input type="date" id="eventEndDate">
                
                <button id="uploadEventBtn">Upload Event</button>
            </div>
            
            <!-- Event Details Modal -->
            <div id="eventDetailsModal" style="display: none;">
                <div class="modal-content">
                <span class="close">&times;</span>
                <img id="eventImageModal" src="" alt="Event Image" style="width: 100%; height: 100%; object-fit: contain; padding: 10px; border-radius: 10px;">
                <h3 id="eventTitleModal"></h3>
                <p id="eventDescriptionModal"></p>
                <button id="editEventBtn">Edit</button>
                <button id="deleteEventBtn">Delete</button>
                </div>
            </div>
            
            <!-- Edit Event Modal -->
            <div id="editEventModal" style="display: none;">
                <div class="modal-content">
                <span class="close">&times;</span>
                <h3>Edit Event</h3>
                <label for="editEventTitle">Title:</label>
                <input type="text" id="editEventTitle" placeholder="Event Title">
                <label for="editEventDescription">Description:</label>
                <textarea id="editEventDescription" placeholder="Event Description"></textarea>
                <button id="saveEditEventBtn">Save</button>
                </div>
            </div>

            <!-- Manage Users Tab -->
            <div id="manageUsers" class="tabcontent hidden">
                <div class="manageusers">
                    <div style="border-bottom: 2px solid black;">
                    <h1>Manage Users</h1>
                            <div id="manageUsersButtons" class="manageuserbutton">
                                <button class="color-change" id="clientsBtn" onclick="openTab(event, 'clients')">Clients</button>
                                <button class="color-change" id="staffBtn" onclick="openTab(event, 'staff')">Laboratory Staff</button>
                                <button class="color-change" id="newRequestsBtn" onclick="openTab(event, 'newRequests')">New User Requests</button>
                            </div>
                    </div>
                    <div id="table-container">
                        <div id="clients-table-container">
                            <div style="display: flex; justify-content: space-between;">
                                <h2>Clients List</h2>
                                <div style="margin-top: auto;">
                                    <input type="text" id="clientSearch" placeholder="Search clients...">
                                    <button id="addClientBtn">Add New Client</button>
                                </div>
                            </div>
                        <table id="clientsTable">
                            <thead>
                                <tr>
                                    <th>Name</th>
                                    <th>Email</th>
                                    <th>No. of Requests</th>
                                    <th>Client Type</th>
                                    <th style="width: 20%;text-align: center;">Action</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Clients will be inserted here -->
                            </tbody>
                        </table>
                    </div>
                    <div id="staff-table-container" style="display: none;">
                        <div style="display: flex; justify-content: space-between;">
                            <h2>Laboratory Staff List</h2>
                            <div style="margin-top: auto;">
                                <input type="text" id="staffSearch" placeholder="Search staff...">
                                <button id="addStaffBtn">Add New Staff</button>
                            </div>
                        </div>
                        <table id="staffTable">
                            <thead>
                                <tr>
                                    <th>Name</th>
                                    <th>Email</th>
                                    <th>No. of Assigned Task</th>
                                    <th style="width: 20%;text-align: center;">Action</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Laboratory staff will be inserted here -->
                            </tbody>
                        </table>
                    </div>
                    <div id="newRequests-table-container" style="display: none;">
                        <h2>New User Requests</h2>
                        <table id="newRequestsTable">
                            <thead>
                                <tr>
                                    <th>Name</th>
                                    <th>Email</th>
                                    <th>Role</th>
                                    <th>Client Type / Department</th>
                                    <th style="width: 20%;text-align: center;">Action</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Dynamic content will be inserted here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            </div>

            <!-- Client Details Modal -->
            <div id="clientDetailsModal" class="modal">
                <div class="modal-content">
                    <span class="close">&times;</span>
                    <!-- Client details will be inserted here -->
                </div>
            </div>

            <!-- Modal for adding a new client -->
            <div id="addClientModal" class="modal">
                <div class="modal-content">
                    <span id="closeAddClientModal" class="close">&times;</span>
                    <h2>Add New Client</h2>
                    <form id="addClientForm">
                        <div style="display: flex; gap: 10px; ">
                            <div style="display: flex;gap:1px;flex-direction: column; width: 33%;">
                                <label for="firstName">First Name:</label> 
                                <input type="text" id="firstName" required>
                            </div>
                        
                            <div style="display: flex;gap:1px;flex-direction: column; width: 33%;">
                                <label for="middleName">Middle Name:</label>
                                <input type="text" id="middleName">
                            </div>
                            
                            <div style="display: flex;gap:1px;flex-direction: column; width: 33%;">
                                <label for="lastName">Last Name:</label>
                                <input type="text" id="lastName" required >
                            </div>
                        </div>

                        <!--<label for="newClientRole">Role:</label>
                        <input type="text" id="newClientRole" value="Client" readonly><br><br> -->

                        <br><label for="newClientEmail">Email:</label>
                        <input type="email" id="newClientEmail" required><br>

                        <label>Client Type:</label><br>
                        <div style="display: flex; gap: 10px; ">
                        <label>
                            <input type="radio" name="clientType" value="Internal" required>
                            Internal Client
                        </label><br>
                        <label>
                            <input type="radio" name="clientType" value="External">
                            External Client
                        </label>
                        </div>
                        
                        <br><br><label for="address">Address:</label>
                        <input type="text" id="address" required><br>
                        
                        <label for="username">Username:</label>
                        <input type="text" id="username" required><br>
                        
                        <label for="contactNumber">Contact Number:</label>
                        <input type="text" id="contactNumber" required><br>
                        <select id="userType" required>
                            <option value="" disabled selected>Select Account Type</option>
                            <option value="student">Student</option>
                            <option value="teacher">Teacher</option>
                        </select>            
                        <label for="school">School:</label>
                        <input type="text" id="school" required><br>
                        
                        <label for="department">Department:</label>
                        <input type="text" id="department" required><br>
                    </form>
                        <button type="submit" id="addClientSubmit">Add Client</button>

                </div>
            </div>

            <!-- Modal for adding a new laboratory staff --> 
            <div id="addStaffModal" class="modal">
                <div class="modal-content">
                    <span id="closeAddStaffModal" class="close">&times;</span>
                    <h2>Add New Laboratory Staff</h2>
                    <form id="addStaffForm">

                        <div style="display: flex; gap: 10px;     height: 100px;">
                            <div style="display: flex;gap:1px;flex-direction: column; width: 33%;">
                                <label for="staffFirstName">First Name:</label>
                                <input type="text" id="staffFirstName" required><br><br>
                            </div>
                        
                            <div style="display: flex;gap:1px;flex-direction: column; width: 33%;">
                                <label for="staffMiddleName">Middle Name:</label>
                                <input type="text" id="staffMiddleName"><br><br>
                            </div>
                            
                            <div style="display: flex;gap:1px;flex-direction: column; width: 33%;">
                                <label for="staffLastName">Last Name:</label>
                                <input type="text" id="staffLastName" required>
                            </div>
                        </div>

                        <label for="staffEmail">Email:</label>
                        <input type="email" id="newStaffEmail" required><br>
                        
                        <!-- <label for="newStaffRole">Role:</label>
                        <input type="text" id="newStaffRole" value="Laboratory Staff" readonly><br><br> -->
                        
                        <label for="staffAddress">Address:</label>
                        <input type="text" id="staffAddress" required><br>
                        
                        <label for="staffUsername">Username:</label>
                        <input type="text" id="staffUsername" required><br>
                        
                        <label for="staffContactNumber">Contact Number:</label>
                        <input type="text" id="staffContactNumber" required><br>
                        
                        <button type="submit" id="addStaffSubmit">Add Staff</button>
                    </form>
                </div>
            </div>

    <!-- Modal Structure -->
    <div id="modal" class="modal">
        <div class="modal-content">
            <span id="modalClose" class="close">&times;</span>
            <div id="modalBody">
                <!-- Modal content will be inserted here -->
            </div>
        </div>
    </div>

    <script src="js/admin-sidebar.js" defer></script> 
    <script type="module" src="js/appointment.js" defer></script> 
    <script type="module" src="js/events.js" defer></script> 
</body>
</html>
